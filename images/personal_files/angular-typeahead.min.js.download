"use strict";angular.module("siyfion.sfTypeahead",[]).value("$typeahead",function(e){e.typeahead.apply(e,Array.prototype.slice.call(arguments,1))}).directive("sfTypeahead",["$typeahead",function(e){return{restrict:"AC",require:"ngModel",scope:{datasets:"=",options:"=",allowCustom:"="},link:function(a,t,n,o){var s,i,l,r=!1,u=null;function c(){u=l?a.$watchCollection("datasets",d):a.$watch("datasets",d)}function d(e,a){if(!angular.equals(e,a)){var t=l;p(),l!==t&&(u(),c())}}function p(){if(null==a.datasets)throw new Error("The datasets parameter is mandatory!");if(s=a.options||{},l=angular.isArray(a.datasets),i=l?a.datasets:[a.datasets],r){var n=t.val();e(t,"destroy"),e(t,s,i),o.$setViewValue(n)}else e(t,s,i),a.$watch("options",p),r=!0}function y(e){for(var a in i){var t=i[a].displayKey||"value";return(angular.isFunction(t)?t(e):e[t])||""}}function h(e){a.$apply(function(){o.$setViewValue(e)})}function f(e){t.bind(e,function(){a.$emit(e,Array.prototype.slice.call(arguments,1))})}p(),c(),o.$parsers.push(function(e){return angular.isObject(o.$modelValue)&&e===y(o.$modelValue)?o.$modelValue:void 0===a.allowCustom||a.allowCustom||"string"!=typeof e?e:o.$modelValue}),o.$formatters.push(function(a){return angular.isObject(a)&&(a=y(a)),e(t,"val",a||""),a}),t.bind("typeahead:select",function(e,t,n){h(t),a.$emit("typeahead:select",t,n)}),t.bind("typeahead:autocomplete",function(e,t,n){h(t),a.$emit("typeahead:autocomplete",t,n)}),f("typeahead:active"),f("typeahead:idle"),f("typeahead:open"),f("typeahead:close"),f("typeahead:change"),f("typeahead:render"),f("typeahead:cursorchange"),f("typeahead:asyncrequest"),f("typeahead:asynccancel"),f("typeahead:asyncreceive")}}}]);